# super_guess

- [attachment](https://github.com/hash-hash/crypto/tree/main/RCTF-2022/super_guess)

经典的HNP，只不过界卡的比较阴间，一开始试了下最简单的构造发现界差的比较多，但是有两优化的点，一个在于key的低位已知，还有一个是正负号的摆动约减1/2的长度。

后面去找了下trx的比赛的题目，发现两比特缺失需要给到110组，这里90组稍微有点少，即使两个优化都用上还是达不到需求

最后上BKZ30发现可以概率性地得到满足的向量

- exp

```python
from Crypto.Util.number import *

q = 1223691195996578113813317636402097933426024864373
A = [353019658104496120050139101132034883612024932797, 1070242257683814193686807837810241426151460014883, 463849169944312880723289276669429474706386689207, 907563643174993934294661847699293353675418349721, 902763704412541097701321539198524968266554778891, 319433733746565851553277856534331596560743329745, 802781852854339531198314546944664579933984156732, 321205590286415796233489926506502395607735076401, 883157779718328637777938957284024678156632622330, 1051241022347263859669892324645021809646337919279, 320114006122691320777330577486841584400845787804, 371874134913795331763180650621425803371198749800, 936106317280755918237613592995987150606141600582, 96973253152685879985444359638440314099613009891, 114538475327786316071743590474888391934984289220, 1128756852194695084793404786101622789226403937029, 861447833216957367097376134233675077450825848854, 983585122121374346735023619237325912697745959250, 999666138490454858801141594480609317160153888767, 881423514599744299901675754561612243317549235296, 454705920798444821685258008219861057546078793026, 547759438392921308167626786712245335844820621418, 489233252734757662811532534478976206806024798383, 1195527450878429938084734941582870118155457031303, 309353339338652073903125948539440276446546499439, 569082099282255290947977921115095702822703583092, 593497070700055966170460038006022271793486364870, 122574630313659748449279055310732479472758316508, 774777237573504374535568586950271606350292778627, 792947751542215187940183823957734416638138030455, 635295674176881882210030533731990455048841017975, 599160174948531239782720454366783847946635134596, 561020292553032521371888160720107575415810750589, 209738920517810015297296407845835854859923952469, 324454764611745764541510318606545137211907180932, 822659400198143843260847252675650131317523278000, 315782146636161260908596488876668222619382785957, 1126628658329992881296509776417204989797979461174, 1212508384229006792202501874838287607399558300590, 228374002928561281969442216131331500694728565487, 229000703987475615338181983758384554147518464304, 923692417768178429954186826365639253986241836065, 670008106705215741475089936312040664050409314022, 96847264290256460530630480898772057127970905841, 727019137079693846556886064308523378559719938673, 1067803714351948606907249471053359961907497203337, 588903472925647634570757899810420901532996112523, 1130144782989878844543976735134563837624299782682, 512328980071176017200869793404120181196871921776, 230172528830019007346521004374109119456745477176, 772178187712114120346188534448347136895229828336, 452697000110230156846464356182919381770969586439, 98534122766280704475932405287717873130827615008, 756048046029708779532207089761887716928079208542, 453909676651958261489302479228156226137758232121, 899666568467021301220212768154546370377958100467, 190462829930692131358661179002867478449173864764, 509601946483458463214894408332860982897982621299, 224749846469073614897030279184493038854417984361, 188668589232131280590988198873346441485668109519, 844080366247280572041603368782441409228893316854, 128173633008291655908185428651970011152270013540, 678787265976678420397734054427723551029963682479, 762058051868917603575410155376777344591929130636, 96388351199816633634769771891835105545735591154, 840107280065370529130280586271675103410609160981, 189878468156505175990434221229763081570874149437, 894596763653276793560512447003343861331127481590, 964924504292420377134228276951233323975840749496, 1154747995729129036826863429062546625044928839543, 1191052602694805782184739227279153301288626370353, 690528719818083989044435969277619662648089316148, 290549435310709273500558092659265497029142064994, 176387450963232701882833816955455939186378960540, 783426443359870984898964401079861370848210734044, 443085869407637240509751063075767437882111819533, 191170050611759444678464800011263358976012982052, 561041354662611886255618854397883468334740890295, 14171561485575521378655777324269352150902385464, 329385619453316151026955278642711085621595476112, 955879765078693314634717258830665741662617741282, 1088561593852588937048018838162620873138615678327, 257886910621877913080644813891444064302076048908, 974940294222342228884880321452802722887526458646, 499064997394504162028941452217545156289484850241, 282127477672289051303248584637031938883291988791, 1105149761511894798274856765331652676892064183994, 802087222978586382131175632511593618426187564752, 674778777146535905204198978920899498352531269160, 920564272609936156508080594502059848569755732632]
B = [337630319878108226821024355258432731519772392674, 31853355438529472499214858639132838580403126541, 908800422428498756599892777441195623903504939442, 895227796831176548695079620221432871573152098155, 248957890528798742623101080236271754681540340673, 422229925417136852429553523601997094779064103268, 1004737119490760923806896102082573534568015397736, 72855465999652054580882478543731587963792444951, 1046146619392779461378038380643706568682186675535, 1071983549142139415002872452683822110131287672589, 1001435006849406481045818189819257903001391127221, 800609632870799916755956095020872852721813045302, 743163104229623419339976589763231511318310449135, 1077861378202784185448616780493054672334859571910, 613712590994308200224126857983626979042881578229, 176684587740762809523257544780970704606992499245, 418305852154526866556084996533996911419417550419, 901062169975459426188173421345446382750495505445, 1057870157269521667271637180047106431714080891708, 270244735234124760024867839156337299271365766339, 1110309545177485176439237723941856668730796780241, 560136710683484894783175972654225543393631325964, 433051614050896638929927045481143073680954600889, 941328413329345592985852213478015005911685702662, 215960195735590793493297892595933783641836428620, 814210003436107162821782054089763302573062013367, 1176801931219426746623177687415172839102405857457, 755031665434513210325594394626373307983068509634, 1075389264721311878290733596772895698065468610280, 16423689192177760902228570989567813992321193254, 720792491382826585022487842060686000464623673309, 852236691677472740665365033320187395445196308381, 1006446295607097499647771505464730853779191415416, 474426411144942897814465904288867842997144183863, 908076079198138705389386818737590549776876156028, 47757805386316395059280841790984854173088142335, 180855679522931453869187314877767408966114411842, 634278691669336190040657275281324552448158015530, 613461863445492152338892302232253952767717159703, 639684045941147901898712373647439251956366305962, 277297313020922817715820010818559304860177537396, 690721122766694204515951613767172383142981578474, 509460343919355612234953916891501197156485983405, 831000573888976276497785915039538879086681043116, 468090145826135592416986477710955801798360811819, 771002733393650953325815854025534850773011008146, 857246374255290122927634366117198992531216698456, 1216865401718006929912548888478914038827509487006, 1206170795231051714810037027537339343225491800535, 266879031441731290545380905322057545018379376605, 599129522630338477923603153086280521041260390552, 849826127343705318824234749594949704200053938722, 440089963992951826501559614988604212404463074789, 624315573244413314508722041181199277910260711296, 1063465689057421137336294216726866911643246409214, 669332669756649710279060157877994851988628846071, 911527301460026927530846659896146691852422631248, 470287408894306110920310716261381285282624974244, 192409792722231544329799424454866839183167559331, 350969720663883926855138678105261360298915009429, 509048064243265993443480792708912164942238992447, 566540202117785708299912109404623121771625331028, 470270957613081045487503930664787048460449166632, 94463697865999767350145126349609195281554206007, 308452020491788540693027814945844833280431822398, 142108134920307304977757829302564162722342766349, 45553965944170396822014467272894835512570917879, 522037087907793875874851528418315719466758109017, 969853006034110593668656348451444873865778757884, 846411897485937835035560813820655943347084441535, 519232492613434685786992634347764734835022449165, 835957687664987669698322258164449869000557017342, 1164481594306065922048100917366488727109111331848, 475120101765250843798386741322253144503564378969, 503971320839392874953205824510858295556513351982, 277342083802606460217685877984407168007063835217, 408049842928366759662705720979426567623682073014, 231682345351288793200024650104837568582075189168, 1064534570295483917573972620127108694179177166344, 153286817849136955521876830779316054407967721498, 9552391623264933536951441175785392803689647974, 256351120666611672446376032712568179330310008496, 332971574113500871596379764903164642401349172079, 720672241698309559737151942982126877767423290232, 464109367949173731591648892860197551735268698258, 995319740091195006445669600945539428595013284678, 952215643439366397714393127840481798125521301112, 1123479643483479247261833790162981193468270108906, 345961759852570061653284751595328192832242829534, 637187488885086303310423228166771951050502115216]
s=409689551476


for i in range(len(A)):
    B[i]=(B[i]-A[i]*s+2^157)%q
L=Matrix(ZZ,92,92)
for i in range(90):
    L[i,i]=q
    L[90,i]=(A[i]*2^40)%q
    L[91,i]=((B[i])%q)
    
L[90,90]=2^37
L[91,91]=2^157
    
basis=list(L.BKZ(block_size=30))

for i in range(len(basis)):
    if basis[i][-1]:
        m=abs(basis[i][-2]//2^37)
        print(long_to_bytes(int(m)),m*2^40+s)
```

